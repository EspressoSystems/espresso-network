if ! has nix_direnv_version || ! nix_direnv_version 3.0.5; then
  source_url "https://raw.githubusercontent.com/nix-community/nix-direnv/3.0.5/direnvrc" "sha256-RuwIS+QKFj/T9M2TFXScjBsLR6V3A17YVoEW/Q6AZ1w="
fi

watch_file rust-toolchain.toml
if nix show-config 2>/dev/null | grep -q "experimental-features.*flakes"; then
  echo "using nix flake"
  use flake
else
  echo "using nix-shell, consider enabling nix flakes: See https://nixos.wiki/wiki/Flakes"
  watch_file flake.nix
  watch_file flake.lock
  use nix
fi
