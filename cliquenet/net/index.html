<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Networking"><title>cliquenet::net - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="cliquenet" data-themes="" data-resource-suffix="" data-rustdoc-version="1.93.0 (254b59607 2026-01-19)" data-channel="1.93.0" data-search-js="search-9e2438ea.js" data-stringdex-js="stringdex-a3946164.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-a410ff4d.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module net</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../cliquenet/index.html">cliquenet</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module net</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#networking" title="Networking">Networking</a><ul><li><a href="#architecture" title="Architecture">Architecture</a></li></ul></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#functions" title="Functions">Functions</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate cliquenet</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">cliquenet</a></div><h1>Module <span>net</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/cliquenet/net.rs.html#1-1226">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="networking"><a class="doc-anchor" href="#networking">Â§</a>Networking</h2>
<p>The networking layer operates over TCP, using the <a href="https://noiseprotocol.org/">Noise protocol framework</a>
to create secure, authenticated links between parties.</p>
<p>Creating a network requires</p>
<ul>
<li>a <code>Keypair</code> whose public key identifies a party,</li>
<li>an address to accept inbound connections on, and</li>
<li>a set of <code>(PublicKey, Address)</code> pairs, comprising all parties that want to communicate.</li>
</ul>
<p>Once created, binary data can be sent to individual parties, addressed by their
<code>PublicKey</code>, or to all parties. Applications can also await receiving data from a party.
For details regarding the API, see <a href="../struct.Network.html" title="struct cliquenet::Network"><code>Network</code></a>.</p>
<h3 id="architecture"><a class="doc-anchor" href="#architecture">Â§</a>Architecture</h3>
<p>When a <a href="../struct.Network.html" title="struct cliquenet::Network"><code>Network</code></a> is created it spawns a server task, that binds a TCP listener to the
provided address and starts accepting connections. It also immediately creates tasks
to connect to each party (except to itself), using the provided address. It then
enters the main event loop which handles task creation and termination. Connections
undergo a series of stages.</p>
<h4 id="accepting-an-inbound-connection"><a class="doc-anchor" href="#accepting-an-inbound-connection">Â§</a>Accepting an inbound connection</h4>
<p>If the TCP listener accepts a new inbound connection it creates a handshake task which
attempts to perform a Noise handshake which involves a Diffie-Hellman key exchange and
â€“ if successful â€“ results in an authenticated and secure link with an identified
peer.</p>
<h4 id="connect-task"><a class="doc-anchor" href="#connect-task">Â§</a>Connect task</h4>
<p>A connect task will indefinitely try to establish a TCP connection to a single peer.
Between connection attempts it waits for an increasing amount of time, but no more
than 30s. If the connection has been established, the task will also perform a Noise
handshake with the remote party.</p>
<p>If either the handshake task or the connect task finish successfully, the connection
is ready to be used for the actual exchange of application data.</p>
<h4 id="ip-address-check"><a class="doc-anchor" href="#ip-address-check">Â§</a>IP address check</h4>
<p>If a partyâ€™s address is an IP address, we also check that the remote peer address is
actually the one given. For domain names, no such check takes place.</p>
<h4 id="simultaneous-connects"><a class="doc-anchor" href="#simultaneous-connects">Â§</a>Simultaneous connects</h4>
<p>Given that all parties try to connect to each other, a network node may accept a
connection it has already established through its own connect task, or vice versa.
A node uses the order of public keys to decide which connection to keep, should
two connections exist at the same time, i.e. given two connections to the same
peer a node drops the one whose associated public key is smaller than its own.</p>
<h4 id="io-tasks"><a class="doc-anchor" href="#io-tasks">Â§</a>I/O tasks</h4>
<p>After successful connection establishment, two tasks are created, one to continuously
read incoming data and one to send application data. The data is split and encrypted
into frames of 64 KiB (the maximum size of a Noise package) or less. Failure of either
task results in the termination of both and a new connect task is created to
re-establish the connection.</p>
<h4 id="heartbeats-and-latency-measurements"><a class="doc-anchor" href="#heartbeats-and-latency-measurements">Â§</a>Heartbeats and latency measurements</h4>
<p>In addition to application data, a network node periodically sends a PING frame and
expects a PONG frame. When a PONG is received the embedded timestamp is used to
measure the network RTT. In addition, whenever a PING frame has been sent, a countdown
timer is started (if not already running) which will cause the connection to be dropped
if finished. Any data that is subsequently received will stop the countdown. This
mechanism is used like a heartbeat to ensure the remote peer is alive and responding.</p>
<h4 id="channels"><a class="doc-anchor" href="#channels">Â§</a>Channels</h4>
<p>Communication between the various tasks proceeds over MPSC (multi producer, single
consumer) channels. When application code wishes to send data, it sends them over
the channel to the main event loop, which will forward the data over another MPSC
channel to the respective write task. The capacity of every channel is bounded.
If the one the application uses is full, backpressure is exercised, i.e. the
application has to wait. This can happen for example, if no connection is available
for some time. The channel to an I/O write task is also bounded, but if full, the
oldest item will be dropped.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.ConnectTask.html" title="struct cliquenet::net::ConnectTask">Connect<wbr>Task</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>A connect task.</dd><dt><a class="struct" href="struct.IoTask.html" title="struct cliquenet::net::IoTask">IoTask</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>An I/O task, reading data from and writing data to a remote party.</dd><dt><a class="struct" href="struct.Network.html" title="struct cliquenet::net::Network">Network</a></dt><dd><code>Network</code> is the API facade of this crate.</dd><dt><a class="struct" href="struct.Peer.html" title="struct cliquenet::net::Peer">Peer</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="struct" href="struct.Server.html" title="struct cliquenet::net::Server">Server</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>The <code>Server</code> is accepting connections and also establishing and
maintaining connections with all parties.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.Command.html" title="enum cliquenet::net::Command">Command</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Server task instructions.</dd><dt><a class="enum" href="enum.Message.html" title="enum cliquenet::net::Message">Message</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Unify the various data types we want to send to the writer task.</dd></dl><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="constant" href="constant.CONNECT_TIMEOUT.html" title="constant cliquenet::net::CONNECT_TIMEOUT">CONNECT_<wbr>TIMEOUT</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Max. allowed duration of a single TCP connect attempt.</dd><dt><a class="constant" href="constant.HANDSHAKE_TIMEOUT.html" title="constant cliquenet::net::HANDSHAKE_TIMEOUT">HANDSHAKE_<wbr>TIMEOUT</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Max. allowed duration of a Noise handshake.</dd><dt><a class="constant" href="constant.MAX_NOISE_HANDSHAKE_SIZE.html" title="constant cliquenet::net::MAX_NOISE_HANDSHAKE_SIZE">MAX_<wbr>NOISE_<wbr>HANDSHAKE_<wbr>SIZE</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Max. message size using noise handshake.</dd><dt><a class="constant" href="constant.MAX_NOISE_MESSAGE_SIZE.html" title="constant cliquenet::net::MAX_NOISE_MESSAGE_SIZE">MAX_<wbr>NOISE_<wbr>MESSAGE_<wbr>SIZE</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Max. message size using noise protocol.</dd><dt><a class="constant" href="constant.MAX_PAYLOAD_SIZE.html" title="constant cliquenet::net::MAX_PAYLOAD_SIZE">MAX_<wbr>PAYLOAD_<wbr>SIZE</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Max. number of bytes for payload data.</dd><dt><a class="constant" href="constant.NOISE_PARAMS.html" title="constant cliquenet::net::NOISE_PARAMS">NOISE_<wbr>PARAMS</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Noise parameters to initialize the builders.</dd><dt><a class="constant" href="constant.PING_INTERVAL.html" title="constant cliquenet::net::PING_INTERVAL">PING_<wbr>INTERVAL</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Interval between ping protocol.</dd><dt><a class="constant" href="constant.REPLY_TIMEOUT.html" title="constant cliquenet::net::REPLY_TIMEOUT">REPLY_<wbr>TIMEOUT</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Max. allowed duration to wait for a peer to answer.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.connect.html" title="fn cliquenet::net::connect">connect</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Connect to the given socket address.</dd><dt><a class="fn" href="fn.handshake.html" title="fn cliquenet::net::handshake">handshake</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Perform a noise handshake as initiator with the remote party.</dd><dt><a class="fn" href="fn.on_handshake.html" title="fn cliquenet::net::on_handshake">on_<wbr>handshake</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Perform a noise handshake as responder with a remote party.</dd><dt><a class="fn" href="fn.recv_frame.html" title="fn cliquenet::net::recv_frame">recv_<wbr>frame</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Read a single frame (header + payload) from the remote.</dd><dt><a class="fn" href="fn.recv_loop.html" title="fn cliquenet::net::recv_loop">recv_<wbr>loop</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Read messages from the remote by assembling frames together.</dd><dt><a class="fn" href="fn.send_frame.html" title="fn cliquenet::net::send_frame">send_<wbr>frame</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Write a single frame (header + payload) to the remote.</dd><dt><a class="fn" href="fn.send_loop.html" title="fn cliquenet::net::send_loop">send_<wbr>loop</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Consume messages to be delivered to remote parties and send them.</dd></dl><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="type" href="type.Budget.html" title="type cliquenet::net::Budget">Budget</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="type" href="type.Result.html" title="type cliquenet::net::Result">Result</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt></dl></section></div></main></body></html>