<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1250px" preserveAspectRatio="none" style="width:1107px;height:1250px;background:#FFFFFF;" version="1.1" viewBox="0 0 1107 1250" width="1107px" zoomAndPan="magnify"><defs/><g><!--MD5=[f7217341b3bb6bbf768c7f0e049f8d09]
cluster Legend--><g id="cluster_Legend"><rect fill="none" height="87" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="472" x="7" y="151"/><path d="M76,151 L76,160.2969 L66,170.2969 L7,170.2969 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="59" x="10" y="164.9951">Legend</text></g><!--MD5=[3746f487d7820090e32c72dc756be46d]
cluster HotShotExternal--><g id="cluster_HotShotExternal"><path d="M950.5,135 L1087.5,135 A3.75,3.75 0 0 1 1090,137.5 L1097,173.5938 L1097.5,173.5938 A2.5,2.5 0 0 1 1100,176.0938 L1100,235.5 A2.5,2.5 0 0 1 1097.5,238 L950.5,238 A2.5,2.5 0 0 1 948,235.5 L948,137.5 A2.5,2.5 0 0 1 950.5,135 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="948" x2="1097" y1="173.5938" y2="173.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="988.5" y="149.9951">HotShot</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="952" y="166.292">(other instances)</text></g><!--MD5=[074479fc2b8718e85f223949db21494f]
cluster Decentralized Sequencer--><g id="cluster_Decentralized Sequencer"><path d="M505.5,6 L706.5,6 A3.75,3.75 0 0 1 709,8.5 L716,28.2969 L921.5,28.2969 A2.5,2.5 0 0 1 924,30.7969 L924,572.5 A2.5,2.5 0 0 1 921.5,575 L505.5,575 A2.5,2.5 0 0 1 503,572.5 L503,8.5 A2.5,2.5 0 0 1 505.5,6 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="503" x2="716" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="200" x="507" y="20.9951">Decentralized Sequencer</text></g><!--MD5=[bcfbdd31683a7d01cd062dc0c4be3661]
cluster zkApp--><g id="cluster_zkApp"><path d="M529.5,49 L615.5,49 A3.75,3.75 0 0 1 618,51.5 L625,71.2969 L897.5,71.2969 A2.5,2.5 0 0 1 900,73.7969 L900,548.5 A2.5,2.5 0 0 1 897.5,551 L529.5,551 A2.5,2.5 0 0 1 527,548.5 L527,51.5 A2.5,2.5 0 0 1 529.5,49 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="527" x2="625" y1="71.2969" y2="71.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="531" y="63.9951">zkEVM app</text></g><!--MD5=[975d7fda8cf98ff1a26ca528bf10cecf]
cluster App--><g id="cluster_App"><path d="M595.5,100 L801.5,100 A3.75,3.75 0 0 1 804,102.5 L811,122.2969 L865.5,122.2969 A2.5,2.5 0 0 1 868,124.7969 L868,267.5 A2.5,2.5 0 0 1 865.5,270 L595.5,270 A2.5,2.5 0 0 1 593,267.5 L593,102.5 A2.5,2.5 0 0 1 595.5,100 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="593" x2="811" y1="122.2969" y2="122.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="205" x="597" y="114.9951">Txn-ordering HotShot app</text></g><!--MD5=[583d55fc1e2a49743832e160d5573292]
cluster HotShot--><g id="cluster_HotShot"><path d="M635.5,151 L699.5,151 A3.75,3.75 0 0 1 702,153.5 L709,173.2969 L833.5,173.2969 A2.5,2.5 0 0 1 836,175.7969 L836,235.5 A2.5,2.5 0 0 1 833.5,238 L635.5,238 A2.5,2.5 0 0 1 633,235.5 L633,153.5 A2.5,2.5 0 0 1 635.5,151 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="633" x2="709" y1="173.2969" y2="173.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="637" y="165.9951">HotShot</text></g><!--MD5=[4499c58aefeb8777a4ef8729a6b9746a]
cluster L1--><g id="cluster_L1"><path d="M646.5,1156 L747.5,1156 A3.75,3.75 0 0 1 750,1158.5 L757,1178.2969 L799.5,1178.2969 A2.5,2.5 0 0 1 802,1180.7969 L802,1240.5 A2.5,2.5 0 0 1 799.5,1243 L646.5,1243 A2.5,2.5 0 0 1 644,1240.5 L644,1158.5 A2.5,2.5 0 0 1 646.5,1156 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="644" x2="757" y1="1178.2969" y2="1178.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="100" x="648" y="1170.9951">Ethereum L1</text></g><!--MD5=[30107c386ad61863a1077fa9b8608265]
cluster L2--><g id="cluster_L2"><path d="M285.5,632 L419.5,632 A3.75,3.75 0 0 1 422,634.5 L429,654.2969 L801.5,654.2969 A2.5,2.5 0 0 1 804,656.7969 L804,1096.5 A2.5,2.5 0 0 1 801.5,1099 L285.5,1099 A2.5,2.5 0 0 1 283,1096.5 L283,634.5 A2.5,2.5 0 0 1 285.5,632 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="283" x2="429" y1="654.2969" y2="654.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133" x="287" y="646.9951">L2 (zkevm-node)</text></g><!--MD5=[72078431e26b572f5b2226d95bfc722b]
cluster HermezProver--><g id="cluster_HermezProver"><path d="M424.5,954 L544.5,954 A3.75,3.75 0 0 1 547,956.5 L554,976.2969 L769.5,976.2969 A2.5,2.5 0 0 1 772,978.7969 L772,1064.5 A2.5,2.5 0 0 1 769.5,1067 L424.5,1067 A2.5,2.5 0 0 1 422,1064.5 L422,956.5 A2.5,2.5 0 0 1 424.5,954 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="422" x2="554" y1="976.2969" y2="976.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="119" x="426" y="968.9951">Hermez Prover</text></g><!--MD5=[72d9b9c3df19f32920b704ceb461b044]
entity Original--><g id="elem_Original"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="151" x="107.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="117.5" y="208.9951">zkevm-node "as is"</text></g><!--MD5=[a113189431ad531dd682dcf46ceaaad4]
entity Modified--><g id="elem_Modified"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169" x="293.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="303.5" y="208.9951">zkevm-node modified</text></g><!--MD5=[f6b1c2ab19eda0ce2a089c48ec5bcba4]
entity New--><g id="elem_New"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49" x="23.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="33.5" y="208.9951">new</text></g><!--MD5=[896ddc638b163aeba3d9eafdbb3e5908]
entity GossipExternal--><g id="elem_GossipExternal"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="964" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="974" y="208.9951">Gossip</text></g><!--MD5=[1fdded0352c3e8b8e8e5fa4c440e3206]
entity Events--><g id="elem_Events"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="733.5" y="341"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="743.5" y="363.9951">Events</text></g><!--MD5=[fc241586e3e4cf255457dad9b5d09a8f]
entity Submit--><g id="elem_Submit"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="553.5" y="341"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="563.5" y="363.9951">Submit API</text></g><!--MD5=[fe0bae4af69ca8947a410fa6d457e8ef]
entity Adapter--><g id="elem_Adapter"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="193" x="690.5" y="499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173" x="700.5" y="521.9951">HotShot-Hermez Adapter</text></g><!--MD5=[50891b5d658e0a5b3a68677ffe19f565]
entity Dispatch--><g id="elem_Dispatch"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="543" y="499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="553" y="521.9951">RPC dispatch</text></g><!--MD5=[72906ce1eb61e5bac7b26d06e51547ad]
entity GossipInternal--><g id="elem_GossipInternal"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="752" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="762" y="208.9951">Gossip</text></g><!--MD5=[657580825c081e24058a2374906e8018]
entity HotShotEvents--><g id="elem_HotShotEvents"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="649.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="659.5" y="208.9951">Events</text></g><!--MD5=[02772cf4a850889cc654a495925d36fb]
entity Rollup--><g id="elem_Rollup"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="660" y="1191"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="670" y="1213.9951">Rollup Contract</text></g><!--MD5=[ee57f16ef1ba8b49a548a5b41deaf6ed]
entity JsonRPC--><g id="elem_JsonRPC"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="585" y="692.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="595" y="715.4951">JsonRPC</text></g><g id="elem_GMN25"><path d="M326,675 L326,745.5313 A0,0 0 0 0 326,745.5313 L550,745.5313 A0,0 0 0 0 550,745.5313 L550,714.5 L584.53,710.5 L550,706.5 L550,685 L540,675 L326,675 A0,0 0 0 0 326,675 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M540,675 L540,685 L550,685 L540,675 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="332" y="692.0669">Optionally dispatch copy of EVM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="332" y="707.1997">txns to JsonRPC and attach a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="332" y="722.3325">fake local mempool for queries</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="332" y="737.4653">with pending txns.</text></g><!--MD5=[58f3bb20197d49c7ea139ae014477a42]
entity L2DB--><g id="elem_L2DB"><path d="M640,837 C640,827 710,827 710,827 C710,827 780,827 780,837 L780,862.2969 C780,872.2969 710,872.2969 710,872.2969 C710,872.2969 640,872.2969 640,862.2969 L640,837 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M640,837 C640,847 710,847 710,847 C710,847 780,847 780,837 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="650" y="863.9951">L2 Blockchain DB</text></g><!--MD5=[45978046dcd5eebeac2fa904e53c0036]
entity Etherman--><g id="elem_Etherman"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="315.5" y="1002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="325.5" y="1024.9951">Etherman</text></g><!--MD5=[30dc00a6e98b45ee3ed5a73adbca65de]
entity Aggregator--><g id="elem_Aggregator"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="335.5" y="831.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="345.5" y="854.4951">Aggregator</text></g><!--MD5=[5c691934b5633fdd3b98f008c74cebb5]
entity State--><g id="elem_State"><rect fill="#98FB98" height="52.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="510" y="823"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="520" y="845.9951">State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="520" y="862.292">Library</text></g><!--MD5=[c3bd79b6cca3d8fa787b3b807ac7237d]
entity Prover--><g id="elem_Prover"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="438" y="1002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="448" y="1024.9951">Prover</text></g><!--MD5=[77b6810f9f1d8e17e1346401c10c77dc]
entity Executor--><g id="elem_Executor"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="537.5" y="1002"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="547.5" y="1024.9951">Executor</text></g><!--MD5=[47b51ac2f4ace7439b689a6295ba6363]
entity Tree--><g id="elem_Tree"><path d="M654,999 C654,989 705,989 705,989 C705,989 756,989 756,999 L756,1040.5938 C756,1050.5938 705,1050.5938 705,1050.5938 C705,1050.5938 654,1050.5938 654,1040.5938 L654,999 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M654,999 C654,1009 705,1009 705,1009 C705,1009 756,1009 756,999 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="664" y="1025.9951">L2 State DB</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="664" y="1042.292">Merkle Tree</text></g><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><g id="elem_User"><rect fill="#FFFFFF" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="308" y="499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="318" y="521.9951">User</text></g><!--MD5=[12c5fa856046bf0246c20874f4cc4349]
link New to Original--><!--MD5=[e97aaf9ac7fa8317af7932e9b00233fd]
link Original to Modified--><!--MD5=[56fe027e5cc5d0f185f1b7694283b179]
link User to Dispatch--><g id="link_User_Dispatch"><path d="M360.38,517 C401.09,517 480.39,517 536.38,517 " fill="none" id="User-to-Dispatch" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="541.23,517,532.23,513,536.23,517,532.23,521,541.23,517" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="425.5" y="495.0669">EVM txn</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="412" y="510.1997">EVM queries</text></g><!--MD5=[92f263ad8a52206631cfcfee518f69c1]
link User to L2--><!--MD5=[9c42c1a64afdc0f74ff55abbc2fbb64f]
link Dispatch to JsonRPC--><g id="link_Dispatch_JsonRPC"><path d="M601.26,535.33 C605.75,569.71 615.79,646.58 620.89,685.68 " fill="none" id="Dispatch-to-JsonRPC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="621.53,690.57,624.3126,681.1224,620.8729,685.6134,616.382,682.1737,621.53,690.57" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="611" y="604.0669">EVM queries</text></g><!--MD5=[7daebf69a253423dbe488f39d44c4ffe]
reverse link Submit to Dispatch--><g id="link_Submit_Dispatch"><path d="M599.85,383.66 C599.65,415.28 599.29,470.59 599.11,498.63 " fill="none" id="Submit-backto-Dispatch" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="599.88,378.8,595.803,387.7654,599.8371,383.7998,603.8027,387.834,599.88,378.8" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="600" y="442.5669">EVM txn</text></g><!--MD5=[91cafd777a61df7305284aff3f8c2f32]
link GossipInternal to GossipExternal--><g id="link_GossipInternal_GossipExternal"><path d="M826.8,204 C870.28,204 913.76,204 957.24,204 " fill="none" id="GossipInternal-GossipExternal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="962.14,204,953.14,200,957.14,204,953.14,208,962.14,204" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="821.88,204,830.88,208,826.88,204,830.88,200,821.88,204" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d6bb6ce03a9f994459ffb589e7e3403e]
link Events to Adapter--><g id="link_Events_Adapter"><path d="M769.22,377.29 C772.81,405.29 779.9,460.59 783.96,492.25 " fill="none" id="Events-to-Adapter" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="784.58,497.13,787.4161,487.6983,783.951,492.1697,779.4796,488.7047,784.58,497.13" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="799.5" y="420.0669">stream:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="781" y="435.1997">order commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="815" y="450.3325">QC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="806.5" y="465.4653">batch</text></g><!--MD5=[f7bb2591de48263be8c8226597d79ad9]
link Adapter to L2DB--><g id="link_Adapter_L2DB"><path d="M782.97,535.3 C770.41,589.22 731.9,754.49 716.48,820.67 " fill="none" id="Adapter-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="715.41,825.29,721.3599,817.4415,716.552,820.4222,713.5714,815.6143,715.41,825.29" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="764" y="715.0669">batch</text></g><!--MD5=[959b278cda2aeba0f8481a95d3753114]
link Adapter to Rollup--><g id="link_Adapter_Rollup"><path d="M799.04,535.3 C820.47,567.83 863,641 863,709.5 C863,709.5 863,709.5 863,1021 C863,1093.34 795.03,1155.66 753.81,1186.8 " fill="none" id="Adapter-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="749.89,1189.72,759.4987,1187.5584,753.902,1186.736,754.7243,1181.1393,749.89,1189.72" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="864" y="846.5669">order commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="898" y="861.6997">QC</text></g><!--MD5=[a8703da4667deee7d0af4e44f6a9eb71]
link JsonRPC to State--><g id="link_JsonRPC_State"><path d="M613.61,728.85 C600.28,751.13 576.91,790.17 560.51,817.58 " fill="none" id="JsonRPC-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="558.1,821.6,566.1604,815.9405,560.6725,817.3125,559.3005,811.8246,558.1,821.6" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="584" y="789.0669">EVM queries</text></g><!--MD5=[23b06c96c58f9e52170abd90e351db28]
link State to L2DB--><g id="link_State_L2DB"><path d="M574.39,849.5 C591.24,849.5 612.62,849.5 633.38,849.5 " fill="none" id="State-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="638.29,849.5,629.29,845.5,633.29,849.5,629.29,853.5,638.29,849.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="592.5" y="842.5669">read</text></g><!--MD5=[afe8f3baa15dd48ff669bede90c045bc]
link State to Tree--><g id="link_State_Tree"><path d="M574.27,869.02 C589.94,878.86 608.46,891.85 623,906 C646.74,929.11 668.5,959.74 683.63,983.29 " fill="none" id="State-to-Tree" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="686.14,987.23,684.6764,977.4905,683.4528,983.0135,677.9299,981.7899,686.14,987.23" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="652" y="926.5669">accounts</text></g><!--MD5=[723ab0c1c62c5caa555c3ea1e025083c]
link State to Executor--><g id="link_State_Executor"><path d="M547.55,876.46 C554.47,908.86 566.21,963.84 572.92,995.2 " fill="none" id="State-to-Executor" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="573.95,1000.04,575.9889,990.4045,572.9092,995.1495,568.1641,992.0698,573.95,1000.04" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="561" y="926.5669">call, etc.</text></g><!--MD5=[9c0e57ae8e5f1edce66b3ebcdb296dbe]
link Aggregator to State--><g id="link_Aggregator_State"><path d="M432.69,849.5 C455.37,849.5 481.98,849.5 503.27,849.5 " fill="none" id="Aggregator-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="508.18,849.5,499.18,845.5,503.18,849.5,499.18,853.5,508.18,849.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="455.25" y="812.5669">fetch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="450.75" y="827.6997">prover</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="455.25" y="842.8325">input</text></g><!--MD5=[5351e065096d48a231f9189815b4e2c0]
link Aggregator to Etherman--><g id="link_Aggregator_Etherman"><path d="M377.61,867.74 C373.88,878.58 369.43,892.92 367,906 C361.34,936.44 359.61,972.19 359.13,995.19 " fill="none" id="Aggregator-to-Etherman" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="359.04,1000.1,363.1937,991.1699,359.1257,995.1007,355.1949,991.0328,359.04,1000.1" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="368" y="926.5669">proof</text></g><!--MD5=[134f1ee58a0da627c1fcf646a8cf7cfa]
link Aggregator to Prover--><g id="link_Aggregator_Prover"><path d="M393.16,867.69 C403.28,886.76 420.01,918.47 434,946 C442.48,962.68 451.82,981.64 458.86,996.05 " fill="none" id="Aggregator-to-Prover" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="460.87,1000.18,460.4983,990.3382,458.6683,995.6908,453.3156,993.8609,460.87,1000.18" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="429" y="919.0669">generate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="441.5" y="934.1997">proof</text></g><!--MD5=[0ca7d036d4fc0c343f6b4beaa6721ac7]
link Etherman to Rollup--><g id="link_Etherman_Rollup"><path d="M366.14,1038.2 C375.77,1059.32 394.9,1094.82 422,1115 C490.85,1166.26 588.4,1189.62 653.59,1200.03 " fill="none" id="Etherman-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="658.31,1200.76,650.0194,1195.4434,653.3676,1200.0029,648.8081,1203.3512,658.31,1200.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="458" y="1136.0669">proof</text></g><!--MD5=[eb6b988b0512d6b84233d2583692179c]
reverse link App to Submit--><g id="link_App_Submit"><path d="M600.5735,270.3932 C600.5494,274.0628 600.525,277.7673 600.5006,281.4718 C600.4518,288.8809 600.403,296.2904 600.3559,303.4223 C600.2619,317.6863 600.175,330.84 600.11,340.66 " fill="none" id="App-backto-Submit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="600.5735,270.3932,596.5144,279.3667,600.5406,275.3931,604.5142,279.4194,600.5735,270.3932" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="601" y="307.0669">wrap in HotShot txn</text></g><!--MD5=[25a03e75ea8af1b5fbad106de56d561d]
link HotShotEvents to Events--><g id="link_HotShotEvents_Events"><path d="M694.01,222.47 C705.06,240.24 722.35,268.67 736,294 C743.2,307.36 750.63,322.64 756.41,334.92 " fill="none" id="HotShotEvents-to-Events" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="758.46,339.31,758.2516,329.4633,756.3331,334.7849,751.0115,332.8664,758.46,339.31" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[dad38233941474e1691494cd43438cef]
@startuml
skinparam componentStyle rectangle

frame Legend {
  component "zkevm-node "as is"" as Original #PaleGreen
  component "zkevm-node modified" as Modified #LightPink
  component "new" as New
}

New -[hidden]r-> Original
Original -[hidden]r-> Modified

component User #White
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component Events
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
    component "HotShot-Hermez Adapter" as Adapter
    component "RPC dispatch" as Dispatch
  }
}


package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup #LightPink
  ' component "Bridge L1" as BridgeL1 #PaleGreen
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Optionally dispatch copy of EVM
    txns to JsonRPC and attach a
    fake local mempool for queries
    with pending txns.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  'component "Bridge L2" as BridgeL2 #PaleGreen
  component Etherman #LightPink
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
}

User -> Dispatch: EVM txn\nEVM queries
'positions the User box in a better place
User -[hidden]> L2

Dispatch - -> JsonRPC: EVM queries
Dispatch -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

Events - -> Adapter: stream:\norder commit\nQC\nbatch

Adapter -> L2DB: batch
Adapter -> Rollup: order commit\nQC

JsonRPC - -> State: EVM queries

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator -> Prover: generate\nproof
Etherman - -> Rollup: proof

' Prover ..> BridgeL2
' User - -> BridgeL1
Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> Events

@enduml

@startuml
skinparam componentStyle rectangle

frame Legend {
  component "zkevm-node "as is"" as Original #PaleGreen
  component "zkevm-node modified" as Modified #LightPink
  component "new" as New
}

New -[hidden]r-> Original
Original -[hidden]r-> Modified

component User #White
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component Events
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
    component "HotShot-Hermez Adapter" as Adapter
    component "RPC dispatch" as Dispatch
  }
}


package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup #LightPink
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Optionally dispatch copy of EVM
    txns to JsonRPC and attach a
    fake local mempool for queries
    with pending txns.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  component Etherman #LightPink
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
}

User -> Dispatch: EVM txn\nEVM queries
User -[hidden]> L2

Dispatch - -> JsonRPC: EVM queries
Dispatch -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

Events - -> Adapter: stream:\norder commit\nQC\nbatch

Adapter -> L2DB: batch
Adapter -> Rollup: order commit\nQC

JsonRPC - -> State: EVM queries

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator -> Prover: generate\nproof
Etherman - -> Rollup: proof

Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> Events

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>